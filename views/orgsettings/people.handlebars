{{> orgheader}}
<ul class="nav nav-tabs" role="tablist">
	<li role="presentation" ><a href="/organizations/{{organization.entry.name}}" role="tab" >Summary</a></li>
	<li role="presentation" class="active"><a href="/organizations/{{organization.entry.name}}/people" role="tab">People</a></li>
	{{#if orgowner}}
	<li role="presentation"><a href="/organizations/{{organization.entry.name}}/settings/profile" role="tab">Settings</a></li>
	{{else}}
	{{/if}}
</ul>
 

{{#if orgowner}}
<p></p>

<table class="table table-bordered" id="organizationOwner">
	<thead>
		<tr>
			<th>
				People
			</th>
		</tr>
	</thead>
	<tbody>
		<tr >
			<td s>
        <div class="media">
          <div class="media-left">
            <a href="">
              {{#if owner.picture}}
              <img src="{{owner.picture}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{else}}
              <img src="{{owner.gravatar}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{/if}}
            </a>
          </div>
          <div class="media-body" >
            <div class="row" >
              <div class="col-md-3">
               <a href="/users/{{owner.username}}"><h4>{{owner.username}}</h4></a>
               <p>Owner</p>
             </div>
             <div class="col-md-6">
              {{dotdotdotdot owner.bio}}
            </div>
            <div class="col-md-3" style="text-align:right" >
             	<a class="btn btn-default"><i class="fa fa-times" aria-hidden="true"></i> Leave</a>
            </div>
          </div>
        </div>
      </div>
			</td>
		</tr>
		{{#each members}}
		<tr>
			<td> 
        <div class="media">
          <div class="media-left">
            <a href="">
              {{#if this.picture}}
              <img src="{{this.picture}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{else}}
              <img src="{{this.gravatar}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{/if}}
            </a>
          </div>
          <div class="media-body">
            <div class="row">
              <div class="col-md-3">
               <a href="/users/{{this.username}}"><h4>{{this.username}}</h4></a>
               <p>Member</p>
             </div>
             <div class="col-md-6">
              {{dotdotdotdot owner.bio}}
            </div>
            <div class="col-md-3" style="text-align:right" >
             	<a class="btn btn-warning"><i class="fa fa-times" aria-hidden="true"></i> Kick</a>
            </div>
          </div>
        </div>
      </div>
			</td>
		</tr>
		{{/each}}
		{{#each requests}}
		<tr style="background: #eee;">
			<td>
        <div class="media">
          <div class="media-left">
            <a href="">
              {{#if this.picture}}
              <img src="{{this.picture}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{else}}
              <img src="{{this.gravatar}}" class="navbar-avatar-pic" style="max-width: 65px;border-radius: 2px;border: 1px;border-color: #d8d8d8;border-style: solid;">
              {{/if}}
            </a>
          </div>
          <div class="media-body">
            <div class="row">
              <div class="col-md-3">
               <a href="/users/{{this.username}}"><h4>{{this.username}}</h4></a>
               <p>Membership request</p>
             </div>
             <div class="col-md-6">
              {{dotdotdotdot owner.bio}}
            </div>
            <div class="col-md-3" style="text-align:right" >
             	<a class="btn btn-default"><i class="fa fa-check" aria-hidden="true"></i>  Approve Request</a>
            </div>
          </div>
        </div>
      </div>
			</td>
		</tr>
		{{/each}}
	</tbody>
</table>

<p></p>
<div >
	<button class="btn btn-success" data-toggle="modal" data-target="#myModal">Invite member</button>
</div>
<p></p>


{{/if}}

 

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-body">
				<div style="text-align: center">
					<h1>
						<i class="fa fa-envelope-o" aria-hidden="true"></i>
					</h1>
					<h3>
						Invite members to {{organization.entry.displayname}}
					</h3>
					<div class="row">
						<div class="col-md-8 col-md-offset-2">
							<form autocomplete="off" >
								<input value="" type="text" name="search" id="search" class="form-control" placeholder="Search by username, full name or email address">
							</form>
							<div id="users" style="padding-top: 25px"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
	$('#search').keyup(function(){
		var searchField = $('#search').val();
		jQuery.ajax({
			'async': true,
			'global': false,
			'url': '/usersearch?item='+searchField,
			'success': function (dataSchemaObject) {
				jQuery('#users').html("")
				if (dataSchemaObject) {
					var html = '<ul class="list-group">'
					for (var i = 0; i < dataSchemaObject.users.length; i++) {
						html+='<li class="list-group-item"><div class="media"><div class="media-left media-middle" > <img src="/uploads/'+dataSchemaObject.users[i]._id+'.jpg " style="max-width: 45px"> </div><div class="media-body" style="text-align: left;"><strong>'+dataSchemaObject.users[i].username+'</strong> '+dataSchemaObject.users[i].username+' <a class="btn btn-default" href="#" role="button" ><i class="fa fa-plus" aria-hidden="true"></i></a>   </div></li>'
					}
					html += '</ul>'
					jQuery('#users').html(html)

				} else {
					jQuery('#users').html("No users found")
				}
			}
		});
	});

 

////////////////////////////////////
////        INITIALIZE         //// 
//////////////////////////////////
$('document').ready(function(){
  var table = jQuery('#organizationOwner').DataTable({
    'destroy':true,
    "pagingType": "numbers",    
    "bLengthChange": false,
  });
})



</script>